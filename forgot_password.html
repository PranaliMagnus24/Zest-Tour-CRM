<!doctype html>
<html lang="en">
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Zest</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, viewport-fit=cover">
    <link href="assets/zestlogo.png" rel="icon">
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="manifest" href="__manifest.json">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
</head>

<body class="bg-white">
    <div class="appHeader no-border transparent position-absolute">
        <div class="pageTitle"></div>
        <div class="right"></div>
    </div>
    <!-- * App Header -->

    <!-- App Capsule -->
    <div id="appCapsule">

        <div class="section mt-2 text-center">
            <img src="assets/zestlogo.png" width="100px">
            <h1>Login</h1>
        </div>
        <div class="section mb-5 p-2 col-lg-5 col-md-5 me-auto ms-auto">
            <div class="col-lg-12 p-0 text-left">
                <div class="form-check mt-2 pull-left" style="width:100%;">
                    <input class="form-check-input" checked="" type="radio" name="type" value="http://localhost/zest_tour_crm/stagging/" data-url="api/login.php" data-req="10" id="holiday">
                    <label class="form-check-label" for="holiday">
                        Holiday CRM
                    </label>
                </div>
                <div class="form-check d-none mt-2 pull-left" style="width:100%;">
                    <input class="form-check-input" type="radio" name="type" value="https://kyc.zestonline.in/" data-url="USER/login" id="kyc" data-req="">
                    <label class="form-check-label" for="kyc">
                        KYC Form
                    </label>
                </div>
                <div class="form-check mt-2 pull-left" style="width:100%;">
                    <input class="form-check-input" type="radio" name="type" value="https://travelreport.zesttourcrm.in/" data-url="api/login.php" id="travelreport" data-req="4">
                    <label class="form-check-label" for="travelreport">
                        Travel Report
                    </label>
                </div>    
                <div class="form-check mt-2 pull-left" style="width:100%;">
                    <input class="form-check-input" type="radio" name="type" value="https://saviour.earth/zestcontact/" data-url="api/index.php/User/login" id="contact" data-req="">
                    <label class="form-check-label" for="contact">
                        Lead Management(Contact form)
                    </label>
                </div>    
            </div>
            <div class=" pull-left w-100 mt-2" id="register_class">

                <div class="card shadow-none">
                    <div class="card-body pb-1 p-0">
                        <div class="form-group basic position-relative">
                            <div class="input-wrapper">
                                <label class="label" for="email1">E-mail</label>

                                <input type="email" class="form-control login-ui" id="e-mail" name="email" autocomplete="off" placeholder="Your e-mail" data-pattern="^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$"
                                    data-required="yes" data-validation-message="Not valid email" data-validation-required-message="This field is required">
                                <i class="clear-input">
                                    <ion-icon name="close-circle"></ion-icon>
                                </i>
                            </div>
                        </div>

                    </div>
                </div>

                <div class="mt-3 me-auto ms-auto transparent verify">
                    <button type="button" id="otp_btn" class="btn btn-primary btn-block btn-lg" onclick="validate('#forgotpass_form','get_email_mobile')" onclick="validate('#register_class','register')" style="background: #0071cd !important;border-color: #0071cd !important;"
                        onclick="validate('#login','login')"><svg class="checkmark hidden" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 52 52"><circle class="checkmark__circle" cx="26" cy="26" r="25" fill="none"/>
                        <path class="checkmark__check" fill="none" d="M14.1 27.2l7.1 7.2 16.7-16.8"/></svg>Send OTP</button>
                </div>
                <div class="form-links mt-2 text-right w-100 justify-content-end">
                    <div>
                        <a href="login.html" style="color: #0071cd;">Back to Login</a>
                    </div>
                    <!-- <div><a href="" class="text-muted">Dont have account Sign Up?</a></div> -->
                </div>

                </form>
            </div>

        </div>

        <div class="modal fade modalbox " id="otp_modal" tabindex="-1" style="display: none;" aria-modal="true" role="dialog">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <div class="modal-header">
                            <a href="#" data-bs-dismiss="modal" style=" float: left; font-size: 26px;">
                                <ion-icon name="chevron-back-outline" style="color: #0071cd !important;"></ion-icon>
                            </a>
                            <span style="
                        justify-content: center;
                        float: left;
                        text-align: center;
                        width: 100%">
                            <h5 class="modal-title">Verification</h5>
                        </span>

                        </div>
                    </div>
                    <div class="modal-body otp">
                        <div id="appCapsule_otp">

                            <div class="section mt-2 text-center">
                                <h1>Enter verification Code</h1>
                                <h4>Enter 5 digit verification code</h4>
                            </div>
                            <div class="section mb-5 p-2">
                                <div>
                                    <div class="form-group basic">
                                        <input type="text" class="form-control verification-input" id="smscode" placeholder="•••••" maxlength="5">
                                    </div>

                                    <div class="mt-3 me-auto ms-auto transparent" onclick="validate('#appCapsule_otp','verifyOTP')">
                                        <button type="button" class="btn btn-primary btn-block btn-lg" style="background: #0071cd !important;border-color: #0071cd !important;"><svg class="checkmark hidden" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 52 52"><circle class="checkmark__circle" cx="26" cy="26" r="25" fill="none"></circle>
                                            <path class="checkmark__check" fill="none" d="M14.1 27.2l7.1 7.2 16.7-16.8"></path></svg>Verify</button>
                                    </div>



                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal fade modalbox" id="pass_modal" tabindex="-1" style="display: none;" aria-modal="true" role="dialog">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <div class="modal-header">

                            <span style="
                            justify-content: center;
                            float: left;
                            text-align: center;
                            width: 100%">
                                <h5 class="modal-title">Password</h5>
                            </span>

                        </div>
                    </div>
                    <div class="modal-body">
                        <div id="appCapsule_pass">



                            <div class="section mt-2 text-center">
                                <h1>Change Password</h1>

                            </div>
                            <div class="section mb-5 p-2 col-lg-5 col-md-5 me-auto ms-auto">
                                <div>
                                    <div class="">
                                        <div class="card-body">


                                            <div class="form-group basic position-relative">
                                                <div class="input-wrapper">
                                                    <label class="label" for="password1">Password</label>
                                                    <input type="password" class="form-control login-ui" name="password" id="create_account_form_password" minlength="4" data-required='yes' data-validation-required-message="This field is required" placeholder="Enter New Password" style="
                                                            background-color: white;
                                                        ">
                                                    <i class="clear-input">
                                                            <ion-icon name="close-circle"></ion-icon>
                                                        </i>

                                                </div>
                                            </div>


                                            <div class="form-group basic position-relative">
                                                <div class="input-wrapper">
                                                    <label class="label" for="password1">Password</label>

                                                    <input type="password" class="form-control login-ui" name="repassword" id="create_account_form_repassword" data-match="create_account_form_password" data-validation-message="Password does not match" data-required='yes' data-validation-required-message="This field is required"
                                                        placeholder="Confirm Password" style="
                                                            background-color: white;
                                                        ">

                                                </div>
                                            </div>





                                        </div>
                                    </div>



                                    <div class="mt-3 me-auto ms-auto transparent">
                                        <button type="submit" class="btn btn-primary btn-block btn-lg" onclick="validate('#appCapsule_pass','update_forgot_password')" style="background: #0071cd !important;border-color: #0071cd !important;">Set New Password</button>



                                    </div>

                                </div>
                            </div>



                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- * App Capsule -->



        <!-- ========= JS Files =========  -->
        <!-- Bootstrap -->
        <script src="assets/js/lib/jquery-3.4.1.min.js"></script>
        <!-- Bootstrap-->
        <script src="assets/js/lib/popper.min.js"></script>
        <script src="assets/js/lib/bootstrap.bundle.min.js"></script>

        <!-- Ionicons -->
        <script src="https://unpkg.com/ionicons@5.0.0/dist/ionicons.js"></script>
        <!-- Splide -->
        <script src="assets/js/plugins/owl-carousel/owl.carousel.min.js"></script>
        <!-- Base Js File -->
        <script src="assets/js/base.js"></script>


</body>

</html>
<script type="text/javascript">
    function get_email_mobile() {
        $("#otp_btn").attr('disabled', true)
        baseurl = $('input[type=radio][name=type]:checked').val();
        url=$('input[type=radio][name=type]:checked').attr('data-url')
        req=$('input[type=radio][name=type]:checked').attr('data-req')
        console.log(baseurl+url+'?'+decodeURIComponent($("#register_class").find('select, textarea, input').serialize()) + '&req='+req)
        
        $.ajax({
            type: "POST",
            url: baseurl+url,
            data: (decodeURIComponent($("#register_class").find('select, textarea, input').serialize())) + '&req='+req,
            success: function(html) {
                console.log(html)
                html=JSON.parse(html)
                $("#otp_btn").attr('disabled', false)
                if (html['success'] == true) {
                    $("#otp_modal").modal('show')
                } else {
                    show_toast(html['message'], "danger", 'big', "center", "inverse");
                }
            }
        });

    }

    function verifyOTP() {


        baseurl = $('input[type=radio][name=type]:checked').val();
        url=$('input[type=radio][name=type]:checked').attr('data-url')
        req=$('input[type=radio][name=type]:checked').attr('data-req')
        user_type_crm = $('input[type=radio][name=flexRadioDefault]:checked').val();

        $.ajax({
            type: "POST",
            url: baseurl + url,
            data: 'otp=' + $("#smscode").val() + '&req=11&email=' + $("#e-mail").val() + '&user_type_crm=' + user_type_crm,
            success: function(html) {



                if (html.trim() == 'verify') {

                    $("#pass_modal").modal('show')

                    show_toast("verified", "success", 'big', "center", "inverse");

                } else {
                    show_toast(html, "danger", 'big', "center", "inverse");

                }

            }
        });

    }

    function update_forgot_password() {

        user_type_crm = $('input[type=radio][name=flexRadioDefault]:checked').val();
        baseurl = $('input[type=radio][name=type]:checked').val();
        url=$('input[type=radio][name=type]:checked').attr('data-url')
        req=$('input[type=radio][name=type]:checked').attr('data-req')
        
        $.ajax({
            type: "POST",
            url: baseurl + url,
            data: $("#appCapsule_pass").find('select, textarea, input').serialize() + '&req=12&email=' + $("#e-mail").val() + '&user_type_crm=' + user_type_crm,
            success: function(html) {
                if (html.trim() == 'Password is updated') {

                    show_toast("Password Updated", "success", 'big', "center", "inverse");
                    setTimeout(function() {
                        window.location.href = 'login.html'
                    }, 1000)
                } else {

                }
            }
        });
    }

    function show_toast(message, type, not_type, pos = 'top', bg = 'inverse') {
        var random = Math.floor(Math.random() * 10);
        if (type == 'danger') {
            $text_type = 'name="close-circle-outline" class="text-danger"'

        } else {
            $text_type = 'name="checkmark-circle" class="text-success"';
        }
        if (not_type == 'big') {
            $('body').append('<div id="toast' + random + '" class="toast-box bg-' + bg + ' text-center toast-' + pos + ' show"><div class="in"><ion-icon ' + $text_type + '></ion-icon><div class="text">' + message + '</div></div></div>')
        } else {
            $('body').append('<div id="toast' + random + '" class="toast-box bg-' + bg + ' text-center toast-' + pos + ' show"><div class="in w-100 p-0"><div class="text">' + message + '</div></div></div>')
        }
        setTimeout(() => {
            $('#toast' + random).removeClass('show');
            $('#toast' + random).remove();
        }, 3000);
        setTimeout(() => {
            $('#toast' + random).remove();
        }, 3500);
    }
</script>